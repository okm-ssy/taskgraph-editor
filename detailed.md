# 要件定義書：タスク詳細エクスポート機能

## 機能要件

### 1. 基本機能
- **概要**: 現在のタスクグラフの全タスクを、実装用TODOリストとして実装先リポジトリにMarkdownファイルで一括エクスポートする
- **エクスポート方式**: 1タスク1ファイル
- **ファイル形式**: Markdown (.md)
- **対象**: プロジェクト内の全タスク

### 2. ファイル命名規則
- **形式**: `task-${連番}-${task-id}.md`
- **連番**: トポロジカルソート順（実装順序）
- **桁数**: 3桁ゼロパディング（001, 002, 003...）

### 3. UI要件
- **配置場所**: EditorGrid.vue の [コンパクト中] ボタンの右側
- **ボタンラベル**: "エクスポート"
- **操作フロー**:
  1. ボタンクリック
  2. エクスポート先パス入力ダイアログ表示
  3. パス入力・確定
  4. 一括エクスポート実行

### 4. 出力内容
- **含める情報**: layout座標以外の全てのタスク情報
- **除外する情報**: addition.layout のみ
- **空項目の処理**: "未設定" プレースホルダーを表示

### 5. Markdownテンプレート
```markdown
# Task: ${task-name}

## 概要
${description || "未設定"}

## 詳細情報
- **難易度**: ${difficulty}h
- **カテゴリ**: ${category || "未設定"}
- **フィールド**: ${field || "未設定"}
- **Issue**: ${issueNumber ? `#${issueNumber}` : "未設定"}

## 依存関係
${depends.length > 0 ? depends.map(d => `- ${d}`).join('\n') : "なし"}

## 要件
${requirements.length > 0 ? requirements.map(r => `- ${r}`).join('\n') : "未設定"}

## 実装ノート
${implementation_notes.length > 0 ? implementation_notes.map(n => `- ${n}`).join('\n') : "未設定"}

## API仕様
${api_schemas.length > 0 ? api_schemas.map(s => `- ${s}`).join('\n') : "未設定"}
```

### 6. エラーハンドリング
- **循環依存**: エラーメッセージ表示して処理中止
- **ファイル書き込みエラー**: エラーメッセージ表示
- **既存ファイル**: 上書き処理

## 実現するための ToDo リスト

### Phase 1: 基盤機能
1. トポロジカルソート機能の実装
2. 循環依存検出機能の実装
3. Markdownテンプレート生成機能の実装

### Phase 2: UI実装
4. エクスポートボタンをEditorGrid.vueに追加
5. パス入力ダイアログコンポーネントの作成
6. エクスポート処理の統合

### Phase 3: ファイル出力
7. ファイル名生成ロジックの実装
8. ファイル書き込み機能の実装
9. エラーハンドリングの実装

### Phase 4: テスト・調整
10. 各種エラーケースのテスト
11. UI/UXの調整

## 代替案

### 代替案1: ZIP形式でのダウンロード
- **内容**: ブラウザからZIPファイルとしてダウンロード
- **採用しない理由**: 実装先リポジトリへの直接配置ができず、手動でのファイル展開が必要になるため

### 代替案2: 単一ファイル出力
- **内容**: 全タスクを1つのMarkdownファイルにまとめて出力
- **採用しない理由**: ファイルサイズが大きくなり、個別タスクの管理・編集が困難になるため

### 代替案3: JSON形式での出力
- **内容**: 構造化データとしてJSON形式で出力
- **採用しない理由**: LLMがMarkdown形式の方が理解しやすく、人間にとっても可読性が高いため
